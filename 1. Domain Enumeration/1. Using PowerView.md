- [**PowerView v3.0** - A PowerShell tool to gain network situational awareness on Windows domains](https://github.com/PowerShellMafia/PowerSploit/blob/master/Recon/PowerView.ps1)
- [**PowerView Wiki**](https://powersploit.readthedocs.io/en/latest/Recon/)
- [**PowerView v3.0 Tips and Tricks**](https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993)

---
- Get help information on commands:
```powershell
Get-Help <Command>
```
- Enumerate the current domain:
```powershell
Get-NetDomain
```
- Enumerate other domains:
```powershell
Get-Domain -Domain <DomainName>
```
- Get the SID for the current domain or the specified domain:
```powershell
Get-DomainSID
```
- Get domain policy:
```powershell
Get-DomainPolicy

# Will show us the policy configurations of the Domain about system access or kerberos
Get-DomainPolicy | Select-Object -ExpandProperty SystemAccess
Get-DomainPolicy | Select-Object -ExpandProperty KerberosPolicy
```
- Enumerate domain controllers:
```powershell
Get-DomainController
Get-DomainController -Domain <DomainName>
```
- Enumerate domain users:
```powershell
# Save all Domain Users to a file
Get-DomainUser | Out-File -FilePath .\DomainUsers.txt

# Will return specific properties of a specific user
Get-DomainUser -Identity <UserName> -Properties DisplayName, MemberOf | Format-List

# Enumerate user logged on a machine
Get-NetLoggedon -ComputerName <ComputerName>

# Enumerate Session Information for a machine
Get-NetSession -ComputerName <ComputerName>

# Enumerate domain machines of the current/specified domain where specific users are logged into
Find-DomainUserLocation -Domain <DomainName> | Select-Object UserName, SessionFromName
```
- Enumerate domain computers:
```powershell
Get-DomainComputer -Properties OperatingSystem, Name, DnsHostName | Sort-Object -Property DnsHostName

# Enumerate Live machines
Get-DomainComputer -Ping -Properties OperatingSystem, Name, DnsHostName | Sort-Object -Property DnsHostName
```
- Enumerate groups and group members:
```powershell
# Save all Domain Groups to a file:
Get-DomainGroup | Out-File -FilePath .\DomainGroup.txt

# Return members of Specific Group (eg. Domain Admins & Enterprise Admins)
Get-DomainGroup -Identity '<GroupName>' | Select-Object -ExpandProperty Member
Get-DomainGroupMember -Identity '<GroupName>' | Select-Object MemberDistinguishedName

# Enumerate the local groups on the local (or remote) machine. Requires local admin rights on the remote machine
Get-NetLocalGroup | Select-Object GroupName

# Enumerates members of a specific local group on the local (or remote) machine. Also requires local admin rights on the remote machine
Get-NetLocalGroupMember -GroupName Administrators | Select-Object MemberName, IsGroup, IsDomain

# Return all GPOs in a domain that modify local group memberships through Restricted Groups or Group Policy Preferences
Get-DomainGPOLocalGroup | Select-Object GPODisplayName, GroupName
```
- Enumerate shares:
```powershell
# Enumerate Domain Shares
Find-DomainShare

# Enumerate Domain Shares the current user has access
Find-DomainShare -CheckShareAccess

# Enumerate "Interesting" Files on accessible shares
Find-InterestingDomainShareFile -Include *passwords*
```
- Enumerate group policies:
```powershell
Get-DomainGPO -Properties DisplayName | Sort-Object -Property DisplayName

# Enumerate all GPOs to a specific computer
Get-DomainGPO -ComputerIdentity <ComputerName> -Properties DisplayName | Sort-Object -Property DisplayName

#G et users that are part of a Machine's local Admin group
Get-DomainGPOComputerLocalGroupMapping -ComputerName <ComputerName>
```
- Enumerate Organizal Units (OUs):
```powershell
Get-DomainOU -Properties Name | Sort-Object -Property Name
```
- Enumerate Access Control Lists (ACLs):
```powershell
# Returns the ACLs associated with the specified account
Get-DomaiObjectAcl -Identity <AccountName> -ResolveGUIDs

# Search for interesting ACEs
Find-InterestingDomainAcl -ResolveGUIDs

# Check the ACLs associated with a specified path (e.g smb share)
Get-PathAcl -Path "\\Path\Of\A\Share"
```
- Enumerate domain trust:
```powershell
Get-DomainTrust
Get-DomainTrust -Domain <DomainName>

# Enumerate all trusts for the current domain and then enumerates all trusts for each domain it finds
Get-DomainTrustMapping
```
- Enumerate forest trust:
```powershell
Get-ForestDomain
Get-ForestDomain -Forest <ForestName>

# Map the Trust of the Forest
Get-ForestTrust
Get-ForestTrust -Forest <ForestName>
```
- User hunting:
```powershell
# Finds all machines on the current domain where the current user has local admin access
Find-LocalAdminAccess -Verbose

# Find local admins on all machines of the domain
Find-DomainLocalGroupMember -Verbose

# Find computers were a Domain Admin OR a spesified user has a session
Find-DomainUserLocation | Select-Object UserName, SessionFromName

# Confirming admin access
Test-AdminAccess
```
- If the above doesn't work, use `PsLoggedOn` (from [**SysInternals Suite**](https://learn.microsoft.com/en-gb/sysinternals/downloads/)) to see user logons at a computer (this relies on the **Remote Registry** service, which has to be enabled):
```powershell
.\PsLoggedon.exe -accepteula \\<ComputerName>
.\PsLoggedon64.exe -accepteula \\<ComputerName>
```
- **Priv Esc to Domain Admin with User Hunting:**
	1. I have local admin access on a machine
	2. A Domain Admin has a session on that machine
	3. I steal his token and impersonate him
	4. Profit!